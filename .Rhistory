dt <- d[d$mean.growing.season < w, ]
plot(log.lpc ~ sd.growing.season, data=dt , col=rangi2 ,
main=paste("Average length of \n growing season < ",w) , xaxp=c(-1,1,2), ylim = c(-10,0), xlim = c(0,6),
xlab="Std dev. of length of \n growing season", ylab = "Log number of languages per capital")
mu <- link(mod3, data=data.frame(mean.growing.season=w,sd.growing.season=sd.growing.season.seq, area = 8.806982e+05))
mu.mean <- apply(mu, 2, mean )
mu.PI <- apply(mu, 2, PI, prob=0.97)
lines(sd.growing.season.seq, mu.mean)
lines(sd.growing.season.seq, mu.PI[1,] , lty=2)
lines(sd.growing.season.seq, mu.PI[2,] , lty=2)
v <- 9.2825
dt <- d[d$mean.growing.season > v, ]
plot(log.lpc ~ sd.growing.season, data=dt , col=rangi2 ,
main=paste("Average length of \n growing season > ",v) , xaxp=c(-1,1,2), ylim = c(-10,0), xlim = c(0,6),
xlab="Std dev. of length of \n growing season", ylab = "Log number of languages per capital")
mu <- link(mod3, data=data.frame(mean.growing.season=v,sd.growing.season=sd.growing.season.seq, area = 8.806982e+05))
mu.mean <- apply(mu, 2, mean)
mu.PI <- apply(mu, 2, PI, prob=0.97)
lines(sd.growing.season.seq, mu.mean)
lines(sd.growing.season.seq, mu.PI[1,] , lty=2)
lines(sd.growing.season.seq, mu.PI[2,] , lty=2)
dt <- d[which(d$mean.growing.season < v), ]
dt <- dt[which(dt$mean.growing.season > w), ]
plot(log.lpc ~ mean.growing.season, data=dt, col=rangi2, main=paste(w, "< Average length of \n  growing season < ", v) , xaxp=c(-1,1,2), ylim = c(-10,0), xlim = c(0,6),
xlab="Std dev. of length of \n growing season", ylab = "Log number of languages per capital")
mu <- link(mod3, data=data.frame(mean.growing.season=7.3550,sd.growing.season=sd.growing.season.seq, area = 8.806982e+05))
mu.mean <- apply(mu, 2, mean )
mu.PI <- apply(mu, 2, PI, prob=0.97)
lines(sd.growing.season.seq, mu.mean)
lines(sd.growing.season.seq, mu.PI[1,] , lty=2)
lines(sd.growing.season.seq, mu.PI[2,] , lty=2)
dt <- d[d$mean.growing.season < w, ]
plot(log.lpc ~ sd.growing.season, data=dt, col=rangi2, main=paste("Average length of \n growing season < ",w) , xaxp=c(-1,1,2), ylim = c(-10,0), xlim = c(0,6),
xlab="Std dev. of length of \n growing season", ylab = "Log number of languages per capital")
mu <- link(mod4, data=data.frame(mean.growing.season=w,sd.growing.season=sd.growing.season.seq, area = 8.806982e+05) )
mu.mean <- apply(mu, 2, mean )
mu.PI <- apply(mu, 2, PI, prob=0.97)
lines(sd.growing.season.seq, mu.mean)
lines(sd.growing.season.seq, mu.PI[1,] , lty=2)
lines(sd.growing.season.seq, mu.PI[2,] , lty=2)
dt <- d[d$mean.growing.season > v, ]
plot(log.lpc ~ sd.growing.season, data=dt, col=rangi2, main=paste("Average length of \n growing season > ",v) , xaxp=c(-1,1,2), ylim = c(-10,0), xlim = c(0,6),
xlab="Std dev. of length of \n growing season", ylab = "Log number of languages per capital")
mu <- link(mod4, data=data.frame(meangrowing.season=v,sd.growing.season=sd.growing.season.seq, area = 8.806982e+05) )
mu.mean <- apply(mu, 2, mean )
mu.PI <- apply(mu, 2, PI, prob=0.97)
lines(sd.growing.season.seq, mu.mean)
lines(sd.growing.season.seq, mu.PI[1,] , lty=2)
lines(sd.growing.season.seq, mu.PI[2,] , lty=2)
dt <- d[which(d$mean.growing.season < v), ]
dt <- dt[which(dt$mean.growing.season > w), ]
plot(log.lpc ~ mean.growing.season, data=dt, col=rangi2, main=paste(w, "< Average length of \n growing season < ", v) , xaxp=c(-1,1,2), ylim = c(-10,0), xlim = c(0,6),
xlab="Std dev. of length of \n growing season", ylab = "Log number of languages per capital")
mu <- link(mod4, data=data.frame(mean.growing.season=7.3550,sd.growing.season=sd.growing.season.seq, area = 8.806982e+05))
mu.mean <- apply(mu, 2, mean )
mu.PI <- apply(mu, 2, PI, prob=0.97)
lines(sd.growing.season.seq, mu.mean)
lines(sd.growing.season.seq, mu.PI[1,] , lty=2)
lines(sd.growing.season.seq, mu.PI[2,] , lty=2)
par(mfrow=c(2,3))
mean.growing.season.seq <- 0:12
w <- 0.9375
dt <- d[d$sd.growing.season < w, ]
plot(log.lpc ~ mean.growing.season, data=dt, col=rangi2, main=paste("Std dev. of length of \n growing season < ", w) , xaxp=c(-1,1,2), ylim = c(-10,0), xlim = c(0,12),
xlab="Average length of growing season", ylab = "Log number of languages per capital")
mu <- link(mod3, data=data.frame(sd.growing.season=w,mean.growing.season=mean.growing.season.seq, area = 8.806982e+05) )
mu.mean <- apply(mu, 2, mean )
mu.PI <- apply(mu, 2, PI, prob=0.97)
lines(mean.growing.season.seq, mu.mean)
lines(mean.growing.season.seq, mu.PI[1,] , lty=2)
lines(mean.growing.season.seq, mu.PI[2,] , lty=2)
v <- 2.1075
dt <- d[d$sd.growing.season > v, ]
plot(log.lpc ~ mean.growing.season, data=dt, col=rangi2, main=paste("Std dev. of length of \n growing season > ", v) , xaxp=c(-1,1,2), ylim = c(-10,0), xlim = c(0,12),
xlab="Average length of growing season", ylab = "Log number of languages per capital")
mu <- link(mod3, data=data.frame(sd.growing.season=v,mean.growing.season=mean.growing.season.seq, area = 8.806982e+05) )
mu.mean <- apply(mu, 2, mean )
mu.PI <- apply(mu, 2, PI, prob=0.97)
lines(mean.growing.season.seq, mu.mean)
lines(mean.growing.season.seq, mu.PI[1,] , lty=2)
lines(mean.growing.season.seq, mu.PI[2,] , lty=2)
dt <- d[which(d$sd.growing.season < v), ]
dt <- dt[which(dt$sd.growing.season > w), ]
plot(log.lpc ~ mean.growing.season, data=dt, col=rangi2, main=paste(w, "< Std dev. of length of \n growing season < ", v) , xaxp=c(-1,1,2), ylim = c(-10,0), xlim = c(0,12),
xlab="Average length of growing season", ylab = "Log number of languages per capital")
mu <- link(mod3, data=data.frame(sd.growing.season=1.6900,mean.growing.season=mean.growing.season.seq, area = 8.806982e+05) )
mu.mean <- apply(mu, 2, mean )
mu.PI <- apply(mu, 2, PI, prob=0.97)
lines(mean.growing.season.seq, mu.mean)
lines(mean.growing.season.seq, mu.PI[1,] , lty=2)
lines(mean.growing.season.seq, mu.PI[2,] , lty=2)
dt <- d[d$sd.growing.season < w, ]
plot(log.lpc ~ mean.growing.season, data=dt, col=rangi2, main=paste("Std dev. of length of \n growing season < ", w) , xaxp=c(-1,1,2), ylim = c(-10,0), xlim = c(0,12),
xlab="Average length of growing season", ylab = "Log number of languages per capital")
mu <- link(mod4, data=data.frame(sd.growing.season=w,mean.growing.season=mean.growing.season.seq, area = 8.806982e+05) )
mu.mean <- apply(mu, 2, mean )
mu.PI <- apply(mu, 2, PI, prob=0.97)
lines(mean.growing.season.seq, mu.mean)
lines(mean.growing.season.seq, mu.PI[1,] , lty=2)
lines(mean.growing.season.seq, mu.PI[2,] , lty=2)
dt <- d[d$sd.growing.season > v, ]
plot(log.lpc ~ mean.growing.season, data=dt, col=rangi2, main=paste("Std dev. of length of \n growing season > ", v) , xaxp=c(-1,1,2), ylim = c(-10,0), xlim = c(0,12),
xlab="Average length of growing season", ylab = "Log number of languages per capital")
mu <- link(mod4, data=data.frame(sd.growing.season=v,mean.growing.season=mean.growing.season.seq, area = 8.806982e+05) )
mu.mean <- apply(mu, 2, mean )
mu.PI <- apply(mu, 2, PI, prob=0.97)
lines(mean.growing.season.seq, mu.mean)
lines(mean.growing.season.seq, mu.PI[1,] , lty=2)
lines(mean.growing.season.seq, mu.PI[2,] , lty=2)
dt <- d[which(d$sd.growing.season < v), ]
dt <- dt[which(dt$sd.growing.season > w), ]
plot(log.lpc ~ mean.growing.season, data=dt, col=rangi2, main=paste(w, "< Std dev. of length of \n growing season < ", v) , xaxp=c(-1,1,2), ylim = c(-10,0), xlim = c(0,12),
xlab="Average length of growing season", ylab = "Log number of languages per capital")
mu <- link(mod4, data=data.frame(sd.growing.season=1.6900,mean.growing.season=mean.growing.season.seq, area = 8.806982e+05) )
mu.mean <- apply(mu, 2, mean )
mu.PI <- apply(mu, 2, PI, prob=0.97)
lines(mean.growing.season.seq, mu.mean)
lines(mean.growing.season.seq, mu.PI[1,] , lty=2)
lines(mean.growing.season.seq, mu.PI[2,] , lty=2)
# Chunk 1
library(rethinking)
library(ggplot2)
library(dplyr)
library(stargazer)
data(nettle)
d <- nettle
d$lang.per.cap <- d$num.lang / d$k.pop
d$log.lpc <- log(d$lang.per.cap)
nettle$country
set.seed(23)
# Chunk 2
mod1 <- map(
alist(
log.lpc ~ dnorm(mu, sigma),
mu <- a + b1 * log(area) + b2*mean.growing.season,
c(a, b1, b2) ~ dnorm(0, 20),
sigma ~ dunif(0, 20)
), data = d
)
mod2 <- map(
alist(
log.lpc ~ dnorm(mu, sigma),
mu <- a + b1 * log(area) + b2*sd.growing.season,
c(a, b1, b2) ~ dnorm(0, 20),
sigma ~ dunif(0, 20)
), data = d
)
mod3 <- map(
alist(
log.lpc ~ dnorm(mu, sigma),
mu <- a + b1 * log(area) + b2*mean.growing.season + b3*sd.growing.season,
c(a, b1, b2, b3) ~ dnorm(0, 20),
sigma ~ dunif(0, 20)
), data = d
)
mod4 <- map(
alist(
log.lpc ~ dnorm(mu, sigma),
mu <- a + b1 * log(area) + b2*mean.growing.season + b3*sd.growing.season + b4*mean.growing.season*sd.growing.season ,
c(a, b1, b2, b3, b4) ~ dnorm(0, 20),
sigma ~ dunif(0, 20)
), data = d
)
# Chunk 3
table1 <- precis(mod1)@output
table2 <- precis(mod2)@output
table3 <- precis(mod3)@output
table4 <- precis(mod4)@output
stargazer(
table1,
type = "latex",
title = "Table of MAP estimates of parameters for Model 1",
summary = FALSE,
header = FALSE
)
# Chunk 4
stargazer(
table2,
type = "latex",
title = "Table of MAP estimates of parameters for Model 2",
summary = FALSE,
header = FALSE
)
# Chunk 5
stargazer(
table3,
type = "latex",
title = "Table of MAP estimates of parameters for Model 3",
summary = FALSE,
header = FALSE
)
# Chunk 6
stargazer(
table4,
type = "latex",
title = "Table of MAP estimates of parameters for Model 4",
summary = FALSE,
header = FALSE
)
# Chunk 7
compare(mod1, mod2, mod3, mod4)
par(mfrow=c(2,3))
mean.growing.season.seq <- 0:12
w <- 0.9375
dt <- d[d$sd.growing.season < w, ]
plot(log.lpc ~ mean.growing.season, data=dt, col=rangi2, main=paste("Std dev. of length of \n growing season < ", w) , xaxp=c(-1,1,2), ylim = c(-10,0), xlim = c(0,12),
xlab="Average length of growing season", ylab = "Log number of languages per capital")
mu <- link(mod3, data=data.frame(sd.growing.season=w,mean.growing.season=mean.growing.season.seq, area = 8.806982e+05) )
mu.mean <- apply(mu, 2, mean )
mu.PI <- apply(mu, 2, PI, prob=0.97)
lines(mean.growing.season.seq, mu.mean)
lines(mean.growing.season.seq, mu.PI[1,] , lty=2)
lines(mean.growing.season.seq, mu.PI[2,] , lty=2)
v <- 2.1075
dt <- d[d$sd.growing.season > v, ]
plot(log.lpc ~ mean.growing.season, data=dt, col=rangi2, main=paste("Std dev. of length of \n growing season > ", v) , xaxp=c(-1,1,2), ylim = c(-10,0), xlim = c(0,12),
xlab="Average length of growing season", ylab = "Log number of languages per capital")
mu <- link(mod3, data=data.frame(sd.growing.season=v,mean.growing.season=mean.growing.season.seq, area = 8.806982e+05) )
mu.mean <- apply(mu, 2, mean )
mu.PI <- apply(mu, 2, PI, prob=0.97)
lines(mean.growing.season.seq, mu.mean)
lines(mean.growing.season.seq, mu.PI[1,] , lty=2)
lines(mean.growing.season.seq, mu.PI[2,] , lty=2)
dt <- d[which(d$sd.growing.season < v), ]
dt <- dt[which(dt$sd.growing.season > w), ]
plot(log.lpc ~ mean.growing.season, data=dt, col=rangi2, main=paste(w, "< Std dev. of length of \n growing season < ", v) , xaxp=c(-1,1,2), ylim = c(-10,0), xlim = c(0,12),
xlab="Average length of growing season", ylab = "Log number of languages per capital")
mu <- link(mod3, data=data.frame(sd.growing.season=1.6900,mean.growing.season=mean.growing.season.seq, area = 8.806982e+05) )
mu.mean <- apply(mu, 2, mean )
mu.PI <- apply(mu, 2, PI, prob=0.97)
lines(mean.growing.season.seq, mu.mean)
lines(mean.growing.season.seq, mu.PI[1,] , lty=2)
lines(mean.growing.season.seq, mu.PI[2,] , lty=2)
dt <- d[d$sd.growing.season < w, ]
plot(log.lpc ~ mean.growing.season, data=dt, col=rangi2, main=paste("Std dev. of length of \n growing season < ", w) , xaxp=c(-1,1,2), ylim = c(-10,0), xlim = c(0,12),
xlab="Average length of growing season", ylab = "Log number of languages per capital")
mu <- link(mod4, data=data.frame(sd.growing.season=w,mean.growing.season=mean.growing.season.seq, area = 8.806982e+05) )
mu.mean <- apply(mu, 2, mean )
mu.PI <- apply(mu, 2, PI, prob=0.97)
lines(mean.growing.season.seq, mu.mean)
lines(mean.growing.season.seq, mu.PI[1,] , lty=2)
lines(mean.growing.season.seq, mu.PI[2,] , lty=2)
dt <- d[d$sd.growing.season > v, ]
plot(log.lpc ~ mean.growing.season, data=dt, col=rangi2, main=paste("Std dev. of length of \n growing season > ", v) , xaxp=c(-1,1,2), ylim = c(-10,0), xlim = c(0,12),
xlab="Average length of growing season", ylab = "Log number of languages per capital")
mu <- link(mod4, data=data.frame(sd.growing.season=v,mean.growing.season=mean.growing.season.seq, area = 8.806982e+05) )
mu.mean <- apply(mu, 2, mean )
mu.PI <- apply(mu, 2, PI, prob=0.97)
lines(mean.growing.season.seq, mu.mean)
lines(mean.growing.season.seq, mu.PI[1,] , lty=2)
lines(mean.growing.season.seq, mu.PI[2,] , lty=2)
dt <- d[which(d$sd.growing.season < v), ]
dt <- dt[which(dt$sd.growing.season > w), ]
plot(log.lpc ~ mean.growing.season, data=dt, col=rangi2, main=paste(w, "< Std dev. of length of \n growing season < ", v) , xaxp=c(-1,1,2), ylim = c(-10,0), xlim = c(0,12),
xlab="Average length of growing season", ylab = "Log number of languages per capital")
mu <- link(mod4, data=data.frame(sd.growing.season=1.6900,mean.growing.season=mean.growing.season.seq, area = 8.806982e+05) )
mu.mean <- apply(mu, 2, mean )
mu.PI <- apply(mu, 2, PI, prob=0.97)
lines(mean.growing.season.seq, mu.mean)
lines(mean.growing.season.seq, mu.PI[1,] , lty=2)
lines(mean.growing.season.seq, mu.PI[2,] , lty=2)
# Chunk 1
library(rethinking)
library(ggplot2)
library(dplyr)
library(stargazer)
data(nettle)
d <- nettle
d$lang.per.cap <- d$num.lang / d$k.pop
d$log.lpc <- log(d$lang.per.cap)
nettle$country
set.seed(23)
# Chunk 2
mod1 <- map(
alist(
log.lpc ~ dnorm(mu, sigma),
mu <- a + b1 * log(area) + b2*mean.growing.season,
c(a, b1, b2) ~ dnorm(0, 20),
sigma ~ dunif(0, 20)
), data = d
)
mod2 <- map(
alist(
log.lpc ~ dnorm(mu, sigma),
mu <- a + b1 * log(area) + b2*sd.growing.season,
c(a, b1, b2) ~ dnorm(0, 20),
sigma ~ dunif(0, 20)
), data = d
)
mod3 <- map(
alist(
log.lpc ~ dnorm(mu, sigma),
mu <- a + b1 * log(area) + b2*mean.growing.season + b3*sd.growing.season,
c(a, b1, b2, b3) ~ dnorm(0, 20),
sigma ~ dunif(0, 20)
), data = d
)
mod4 <- map(
alist(
log.lpc ~ dnorm(mu, sigma),
mu <- a + b1 * log(area) + b2*mean.growing.season + b3*sd.growing.season + b4*mean.growing.season*sd.growing.season ,
c(a, b1, b2, b3, b4) ~ dnorm(0, 20),
sigma ~ dunif(0, 20)
), data = d
)
# Chunk 3
table1 <- precis(mod1)@output
table2 <- precis(mod2)@output
table3 <- precis(mod3)@output
table4 <- precis(mod4)@output
stargazer(
table1,
type = "latex",
title = "Table of MAP estimates of parameters for Model 1",
summary = FALSE,
header = FALSE
)
# Chunk 4
stargazer(
table2,
type = "latex",
title = "Table of MAP estimates of parameters for Model 2",
summary = FALSE,
header = FALSE
)
# Chunk 5
stargazer(
table3,
type = "latex",
title = "Table of MAP estimates of parameters for Model 3",
summary = FALSE,
header = FALSE
)
# Chunk 6
stargazer(
table4,
type = "latex",
title = "Table of MAP estimates of parameters for Model 4",
summary = FALSE,
header = FALSE
)
# Chunk 7
compare(mod1, mod2, mod3, mod4)
# Chunk 8
par(mfrow=c(2,3))
mean.growing.season.seq <- 0:12
w <- 0.9375
dt <- d[d$sd.growing.season < w, ]
plot(log.lpc ~ mean.growing.season, data=dt, col=rangi2, main=paste("Std dev. of length of \n growing season < ", w) , xaxp=c(-1,1,2), ylim = c(-10,0), xlim = c(0,12),
xlab="Average length of growing season", ylab = "Log number of languages per capital")
mu <- link(mod3, data=data.frame(sd.growing.season=w,mean.growing.season=mean.growing.season.seq, area = 8.806982e+05) )
mu.mean <- apply(mu, 2, mean )
mu.PI <- apply(mu, 2, PI, prob=0.97)
lines(mean.growing.season.seq, mu.mean)
lines(mean.growing.season.seq, mu.PI[1,] , lty=2)
lines(mean.growing.season.seq, mu.PI[2,] , lty=2)
v <- 2.1075
dt <- d[d$sd.growing.season > v, ]
plot(log.lpc ~ mean.growing.season, data=dt, col=rangi2, main=paste("Std dev. of length of \n growing season > ", v) , xaxp=c(-1,1,2), ylim = c(-10,0), xlim = c(0,12),
xlab="Average length of growing season", ylab = "Log number of languages per capital")
mu <- link(mod3, data=data.frame(sd.growing.season=v,mean.growing.season=mean.growing.season.seq, area = 8.806982e+05) )
mu.mean <- apply(mu, 2, mean )
mu.PI <- apply(mu, 2, PI, prob=0.97)
lines(mean.growing.season.seq, mu.mean)
lines(mean.growing.season.seq, mu.PI[1,] , lty=2)
lines(mean.growing.season.seq, mu.PI[2,] , lty=2)
dt <- d[which(d$sd.growing.season < v), ]
dt <- dt[which(dt$sd.growing.season > w), ]
plot(log.lpc ~ mean.growing.season, data=dt, col=rangi2, main=paste(w, "< Std dev. of length of \n growing season < ", v) , xaxp=c(-1,1,2), ylim = c(-10,0), xlim = c(0,12),
xlab="Average length of growing season", ylab = "Log number of languages per capital")
mu <- link(mod3, data=data.frame(sd.growing.season=1.6900,mean.growing.season=mean.growing.season.seq, area = 8.806982e+05) )
mu.mean <- apply(mu, 2, mean )
mu.PI <- apply(mu, 2, PI, prob=0.97)
lines(mean.growing.season.seq, mu.mean)
lines(mean.growing.season.seq, mu.PI[1,] , lty=2)
lines(mean.growing.season.seq, mu.PI[2,] , lty=2)
dt <- d[d$sd.growing.season < w, ]
plot(log.lpc ~ mean.growing.season, data=dt, col=rangi2, main=paste("Std dev. of length of \n growing season < ", w) , xaxp=c(-1,1,2), ylim = c(-10,0), xlim = c(0,12),
xlab="Average length of growing season", ylab = "Log number of languages per capital")
mu <- link(mod4, data=data.frame(sd.growing.season=w,mean.growing.season=mean.growing.season.seq, area = 8.806982e+05) )
mu.mean <- apply(mu, 2, mean )
mu.PI <- apply(mu, 2, PI, prob=0.97)
lines(mean.growing.season.seq, mu.mean)
lines(mean.growing.season.seq, mu.PI[1,] , lty=2)
lines(mean.growing.season.seq, mu.PI[2,] , lty=2)
dt <- d[d$sd.growing.season > v, ]
plot(log.lpc ~ mean.growing.season, data=dt, col=rangi2, main=paste("Std dev. of length of \n growing season > ", v) , xaxp=c(-1,1,2), ylim = c(-10,0), xlim = c(0,12),
xlab="Average length of growing season", ylab = "Log number of languages per capital")
mu <- link(mod4, data=data.frame(sd.growing.season=v,mean.growing.season=mean.growing.season.seq, area = 8.806982e+05) )
mu.mean <- apply(mu, 2, mean )
mu.PI <- apply(mu, 2, PI, prob=0.97)
lines(mean.growing.season.seq, mu.mean)
lines(mean.growing.season.seq, mu.PI[1,] , lty=2)
lines(mean.growing.season.seq, mu.PI[2,] , lty=2)
dt <- d[which(d$sd.growing.season < v), ]
dt <- dt[which(dt$sd.growing.season > w), ]
plot(log.lpc ~ mean.growing.season, data=dt, col=rangi2, main=paste(w, "< Std dev. of length of \n growing season < ", v) , xaxp=c(-1,1,2), ylim = c(-10,0), xlim = c(0,12),
xlab="Average length of growing season", ylab = "Log number of languages per capital")
mu <- link(mod4, data=data.frame(sd.growing.season=1.6900,mean.growing.season=mean.growing.season.seq, area = 8.806982e+05) )
mu.mean <- apply(mu, 2, mean )
mu.PI <- apply(mu, 2, PI, prob=0.97)
lines(mean.growing.season.seq, mu.mean)
lines(mean.growing.season.seq, mu.PI[1,] , lty=2)
lines(mean.growing.season.seq, mu.PI[2,] , lty=2)
par(mfrow=c(2,3))
sd.growing.season.seq <- 0:6
w <- 5.3475
dt <- d[d$mean.growing.season < w, ]
plot(log.lpc ~ sd.growing.season, data=dt , col=rangi2 ,
main=paste("Average length of \n growing season < ",w) , xaxp=c(-1,1,2), ylim = c(-10,0), xlim = c(0,6),
xlab="Std dev. of length of \n growing season", ylab = "Log number of languages per capital")
mu <- link(mod3, data=data.frame(mean.growing.season=w,sd.growing.season=sd.growing.season.seq, area = 8.806982e+05))
mu.mean <- apply(mu, 2, mean )
mu.PI <- apply(mu, 2, PI, prob=0.97)
lines(sd.growing.season.seq, mu.mean)
lines(sd.growing.season.seq, mu.PI[1,] , lty=2)
lines(sd.growing.season.seq, mu.PI[2,] , lty=2)
v <- 9.2825
dt <- d[d$mean.growing.season > v, ]
plot(log.lpc ~ sd.growing.season, data=dt , col=rangi2 ,
main=paste("Average length of \n growing season > ",v) , xaxp=c(-1,1,2), ylim = c(-10,0), xlim = c(0,6),
xlab="Std dev. of length of \n growing season", ylab = "Log number of languages per capital")
mu <- link(mod3, data=data.frame(mean.growing.season=v,sd.growing.season=sd.growing.season.seq, area = 8.806982e+05))
mu.mean <- apply(mu, 2, mean)
mu.PI <- apply(mu, 2, PI, prob=0.97)
lines(sd.growing.season.seq, mu.mean)
lines(sd.growing.season.seq, mu.PI[1,] , lty=2)
lines(sd.growing.season.seq, mu.PI[2,] , lty=2)
dt <- d[which(d$mean.growing.season < v), ]
dt <- dt[which(dt$mean.growing.season > w), ]
plot(log.lpc ~ mean.growing.season, data=dt, col=rangi2, main=paste(w, "< Average length of \n  growing season < ", v) , xaxp=c(-1,1,2), ylim = c(-10,0), xlim = c(0,6),
xlab="Std dev. of length of \n growing season", ylab = "Log number of languages per capital")
mu <- link(mod3, data=data.frame(mean.growing.season=7.3550,sd.growing.season=sd.growing.season.seq, area = 8.806982e+05))
mu.mean <- apply(mu, 2, mean )
mu.PI <- apply(mu, 2, PI, prob=0.97)
lines(sd.growing.season.seq, mu.mean)
lines(sd.growing.season.seq, mu.PI[1,] , lty=2)
lines(sd.growing.season.seq, mu.PI[2,] , lty=2)
dt <- d[d$mean.growing.season < w, ]
plot(log.lpc ~ sd.growing.season, data=dt, col=rangi2, main=paste("Average length of \n growing season < ",w) , xaxp=c(-1,1,2), ylim = c(-10,0), xlim = c(0,6),
xlab="Std dev. of length of \n growing season", ylab = "Log number of languages per capital")
mu <- link(mod4, data=data.frame(mean.growing.season=w,sd.growing.season=sd.growing.season.seq, area = 8.806982e+05) )
mu.mean <- apply(mu, 2, mean )
mu.PI <- apply(mu, 2, PI, prob=0.97)
lines(sd.growing.season.seq, mu.mean)
lines(sd.growing.season.seq, mu.PI[1,] , lty=2)
lines(sd.growing.season.seq, mu.PI[2,] , lty=2)
dt <- d[d$mean.growing.season > v, ]
plot(log.lpc ~ sd.growing.season, data=dt, col=rangi2, main=paste("Average length of \n growing season > ",v) , xaxp=c(-1,1,2), ylim = c(-10,0), xlim = c(0,6),
xlab="Std dev. of length of \n growing season", ylab = "Log number of languages per capital")
mu <- link(mod4, data=data.frame(meangrowing.season=v,sd.growing.season=sd.growing.season.seq, area = 8.806982e+05) )
mu.mean <- apply(mu, 2, mean )
mu.PI <- apply(mu, 2, PI, prob=0.97)
lines(sd.growing.season.seq, mu.mean)
lines(sd.growing.season.seq, mu.PI[1,] , lty=2)
lines(sd.growing.season.seq, mu.PI[2,] , lty=2)
dt <- d[which(d$mean.growing.season < v), ]
dt <- dt[which(dt$mean.growing.season > w), ]
plot(log.lpc ~ mean.growing.season, data=dt, col=rangi2, main=paste(w, "< Average length of \n growing season < ", v) , xaxp=c(-1,1,2), ylim = c(-10,0), xlim = c(0,6),
xlab="Std dev. of length of \n growing season", ylab = "Log number of languages per capital")
mu <- link(mod4, data=data.frame(mean.growing.season=7.3550,sd.growing.season=sd.growing.season.seq, area = 8.806982e+05))
mu.mean <- apply(mu, 2, mean )
mu.PI <- apply(mu, 2, PI, prob=0.97)
lines(sd.growing.season.seq, mu.mean)
lines(sd.growing.season.seq, mu.PI[1,] , lty=2)
lines(sd.growing.season.seq, mu.PI[2,] , lty=2)
unlink('Bayesian/HW07_cache', recursive = TRUE)
summary(m1)
m.5 <- BayesSenMC::randCorrOR(a = 66, N1 = 11782, c = 243, N0 = 57973, m.lg.se = 1.069,
m.lg.sp = 1.126, s.lg.se = 0.893, s.lg.sp = 0.712, m.z = -0.399, s.z = 0.139,
chains = 3, iter = 10000, traceplot = TRUE)
getwd()
setwd("BayesSenMC")
library(devtools)
devtools::check()
y <- data.frame()
y$xx <- c(1,2,3)
a <- c(1,2,3)
b <- c(4,5,6)
data.frame(a,b)
data.frame(a,b)$a
devtools::check()
stats::dlnorm(0,1)
library(stats)
devtools::check()
my.mod <- randCorrOR(a = 66, N1 = 11782, c = 243, N0 = 57973, m.lg.se = 1.069, m.lg.sp = 1.126, s.lg.se = 0.893, s.lg.sp = 0.712, m.z = -0.399, s.z = 0.139, chains = 3, iter = 10000, seed = 0)
my.mod <- BayesSenMC::randCorrOR(a = 66, N1 = 11782, c = 243, N0 = 57973, m.lg.se = 1.069, m.lg.sp = 1.126, s.lg.se = 0.893, s.lg.sp = 0.712, m.z = -0.399, s.z = 0.139, chains = 3, iter = 10000, seed = 0)
devtools::check()
c(1,2,3) + c(4,5,6)
devtools::check()
devtools::check()
devtools::check()
devtools::check()
devtools::check()
document()
document()
devtools::check()
document()
setwd("..")
install("BayesSenMC")
library("BayesSenMC")
setwd("BayesSenMC")
devtools::check()
document()
devtools::check()
document()
devtools::check()
devtools::check()
document()
devtools::check()
install.packages("instaR")
library(instaR)
